{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["import './style.css';\r\n\r\nexport class MediumEditor {\r\n    constructor(el, action_bar) {\r\n        this.rootElement = el;\r\n        this.rootElement.classList.add('medium-editor');\r\n        this.action_bar = action_bar;\r\n\r\n        this.rootElement.addEventListener('mouseup', evt => {\r\n            if (this.rootElement.getAttribute('contenteditable') == 'true') {\r\n                let sel = document.getSelection();\r\n\r\n                if (sel.type === 'Range') {\r\n                    if (sel.rangeCount > 0) {\r\n                        this.action_bar.rootElement.classList.add('active');\r\n\r\n                        setTimeout(() => {\r\n                            this.action_bar.getBoundingRect();\r\n\r\n                            let range = sel.getRangeAt(0);\r\n                            let bounding_rect = range.getBoundingClientRect();\r\n                            let left = ((bounding_rect.x + (bounding_rect.width - this.action_bar.width) / 2));\r\n                            let top = bounding_rect.y - this.action_bar.height - this.action_bar.gap + window.scrollY;\r\n\r\n                            if (left < this.action_bar.gap) {left = this.action_bar.gap};\r\n                            if ((left + this.action_bar.width) > window.innerWidth) {left = window.innerWidth - this.action_bar.width - this.action_bar.gap};\r\n                            if (top < this.action_bar.gap) {top = this.action_bar.gap};\r\n                            if (top > window.innerHeight - this.action_bar.gap) {top = window.innerHeight - this.action_bar.height - this.action_bar.gap};\r\n\r\n                            this.action_bar.show(this.rootElement, left, top);\r\n                        }, 10)\r\n                    } else {\r\n                        this.action_bar.hide();\r\n                    }\r\n                } else {\r\n                    this.action_bar.hide();\r\n                }\r\n            }\r\n        })\r\n\r\n        this.rootElement.addEventListener('blur', (evt) => {\r\n            let target = evt.explicitOriginalTarget;\r\n            let is_action_bar = false;\r\n\r\n            if (target && target instanceof HTMLElement) {\r\n                if (target.closest('[data-role=\"action-bar\"]')) {\r\n                    is_action_bar = true;\r\n                }\r\n            }\r\n\r\n            if (!is_action_bar) {\r\n                if (this.action_bar.editor === this.rootElement) {\r\n                    this.action_bar.hide();\r\n                }\r\n            }\r\n        })\r\n    }\r\n}"],"names":["MediumEditor","el","action_bar","evt","sel","bounding_rect","left","top","target","is_action_bar"],"mappings":"AAEO,MAAMA,EAAa;AAAA,EACtB,YAAYC,GAAIC,GAAY;AACxB,SAAK,cAAcD,GACnB,KAAK,YAAY,UAAU,IAAI,eAAe,GAC9C,KAAK,aAAaC,GAElB,KAAK,YAAY,iBAAiB,WAAW,CAAAC,MAAO;AAChD,UAAI,KAAK,YAAY,aAAa,iBAAiB,KAAK,QAAQ;AAC5D,YAAIC,IAAM,SAAS;AAEnB,QAAIA,EAAI,SAAS,UACTA,EAAI,aAAa,KACjB,KAAK,WAAW,YAAY,UAAU,IAAI,QAAQ,GAElD,WAAW,MAAM;AACb,eAAK,WAAW;AAGhB,cAAIC,IADQD,EAAI,WAAW,CAAC,EACF,yBACtBE,IAASD,EAAc,KAAKA,EAAc,QAAQ,KAAK,WAAW,SAAS,GAC3EE,IAAMF,EAAc,IAAI,KAAK,WAAW,SAAS,KAAK,WAAW,MAAM,OAAO;AAElF,UAAIC,IAAO,KAAK,WAAW,QAAMA,IAAO,KAAK,WAAW,MACnDA,IAAO,KAAK,WAAW,QAAS,OAAO,eAAaA,IAAO,OAAO,aAAa,KAAK,WAAW,QAAQ,KAAK,WAAW,MACxHC,IAAM,KAAK,WAAW,QAAMA,IAAM,KAAK,WAAW,MAClDA,IAAM,OAAO,cAAc,KAAK,WAAW,QAAMA,IAAM,OAAO,cAAc,KAAK,WAAW,SAAS,KAAK,WAAW,MAEzH,KAAK,WAAW,KAAK,KAAK,aAAaD,GAAMC,CAAG;AAAA,QACnD,GAAE,EAAE,KAEL,KAAK,WAAW,SAGpB,KAAK,WAAW;MAEvB;AAAA,IACb,CAAS,GAED,KAAK,YAAY,iBAAiB,QAAQ,CAACJ,MAAQ;AAC/C,UAAIK,IAASL,EAAI,wBACbM,IAAgB;AAEpB,MAAID,KAAUA,aAAkB,eACxBA,EAAO,QAAQ,0BAA0B,MACzCC,IAAgB,KAInBA,KACG,KAAK,WAAW,WAAW,KAAK,eAChC,KAAK,WAAW;IAGpC,CAAS;AAAA,EACJ;AACL;"}