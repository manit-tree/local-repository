{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["import './style.css';\r\n\r\nlet timer = null;\r\n\r\nexport class ActionBar {\r\n    constructor(options) {\r\n        let default_options = {\r\n            gap: 8,\r\n            timeout: 5000,\r\n            commands: [\r\n                {\r\n                    \"cmd\":\"bold\",\r\n                    \"icon\":\"\"\r\n                },\r\n                {\r\n                    \"cmd\":\"italic\",\r\n                    \"icon\":\"\"\r\n                },\r\n                {\r\n                    \"cmd\":\"|\"\r\n                },\r\n                {\r\n                    \"cmd\":\"remove-style\",\r\n                    \"icon\":\"\"\r\n                },\r\n                {\r\n                    \"cmd\":\"link\",\r\n                    \"icon\":\"\"\r\n                },\r\n                {\r\n                    \"cmd\":\"unlink\",\r\n                    \"icon\":\"\"\r\n                }\r\n            ]            \r\n        }\r\n\r\n        let _options = Object.assign(default_options, options);\r\n        \r\n        this.gap = _options.gap;\r\n        this.timeout = _options.timeout;\r\n        this.commands = _options.commands;\r\n        this.rootElement = document.createElement('div');\r\n        this.rootElement.setAttribute('data-role', 'action-bar');\r\n\r\n        let sb = new Array();\r\n\r\n        _options.commands.forEach(item => {\r\n            if (item.cmd == '|') {\r\n                sb.push('<span class=\"seperator\"></span>');\r\n            } else {\r\n                sb.push('<span data-cmd=\"' + item.cmd + '\" style=\"' + (item.scale?('--scale:' + item.scale + ';'):'') + (item.top?('--top:' + item.top + ';'):'') + '\">' + item.icon +'</span>');\r\n            }\r\n        })\r\n\r\n        this.rootElement.innerHTML = sb.join('');\r\n        this.getBoundingRect();\r\n\r\n        this.rootElement.addEventListener('mouseenter', () => {\r\n            clearTimeout(timer);\r\n        })\r\n\r\n        this.rootElement.addEventListener('mouseleave', () => {\r\n            clearTimeout(timer);\r\n\r\n            timer = setTimeout(() => {\r\n                this.hide();\r\n            }, this.timeout)\r\n        })\r\n\r\n        this.rootElement.addEventListener('click', evt => {\r\n            clearTimeout(timer);\r\n            let target = evt.target;\r\n\r\n            if (target.matches('span[data-cmd]')) {\r\n                let cmd = target.getAttribute('data-cmd');\r\n\r\n                let filtered_commands = this.commands.filter(item => {\r\n                    return item.cmd == cmd;\r\n                })\r\n\r\n                if (filtered_commands.length > 0) {\r\n                    cmd = filtered_commands[0];\r\n\r\n                    if (typeof cmd.action == 'function') {\r\n                        cmd.action();\r\n                    }\r\n                }\r\n\r\n                this.hide();\r\n            }\r\n        })\r\n\r\n        document.body.append(this.rootElement);\r\n    }\r\n\r\n    getBoundingRect() {\r\n        let bounding_rect = this.rootElement.getBoundingClientRect();\r\n    \r\n        this.width = bounding_rect.width;\r\n        this.height = bounding_rect.height;\r\n    }\r\n\r\n    show(el, x, y) {\r\n        clearTimeout(timer);\r\n        this.editor = el;\r\n        this.rootElement.setAttribute('class', '');\r\n        this.rootElement.style.left = x + 'px';\r\n        this.rootElement.style.top = y + 'px';\r\n        this.rootElement.classList.add('active');\r\n        this.rootElement.classList.add('fade-in');\r\n\r\n        timer = setTimeout(() => {\r\n            clearTimeout(timer);\r\n            this.hide();    \r\n        }, this.timeout)\r\n    }\r\n\r\n    hide() {\r\n        clearTimeout(timer);\r\n        this.rootElement.classList.remove('active');\r\n    }\r\n}\r\n"],"names":["timer","ActionBar","options","_options","sb","item","evt","target","cmd","filtered_commands","bounding_rect","el","x","y"],"mappings":"AAEA,IAAIA,IAAQ;AAEL,MAAMC,EAAU;AAAA,EACnB,YAAYC,GAAS;AA+BjB,QAAIC,IAAW,OAAO,OA9BA;AAAA,MAClB,KAAK;AAAA,MACL,SAAS;AAAA,MACT,UAAU;AAAA,QACN;AAAA,UACI,KAAM;AAAA,UACN,MAAO;AAAA,QACV;AAAA,QACD;AAAA,UACI,KAAM;AAAA,UACN,MAAO;AAAA,QACV;AAAA,QACD;AAAA,UACI,KAAM;AAAA,QACT;AAAA,QACD;AAAA,UACI,KAAM;AAAA,UACN,MAAO;AAAA,QACV;AAAA,QACD;AAAA,UACI,KAAM;AAAA,UACN,MAAO;AAAA,QACV;AAAA,QACD;AAAA,UACI,KAAM;AAAA,UACN,MAAO;AAAA,QACV;AAAA,MACJ;AAAA,IACJ,GAE6CD,CAAO;AAErD,SAAK,MAAMC,EAAS,KACpB,KAAK,UAAUA,EAAS,SACxB,KAAK,WAAWA,EAAS,UACzB,KAAK,cAAc,SAAS,cAAc,KAAK,GAC/C,KAAK,YAAY,aAAa,aAAa,YAAY;AAEvD,QAAIC,IAAK,IAAI;AAEb,IAAAD,EAAS,SAAS,QAAQ,CAAAE,MAAQ;AAC9B,MAAIA,EAAK,OAAO,MACZD,EAAG,KAAK,iCAAiC,IAEzCA,EAAG,KAAK,qBAAqBC,EAAK,MAAM,eAAeA,EAAK,QAAO,aAAaA,EAAK,QAAQ,MAAK,OAAOA,EAAK,MAAK,WAAWA,EAAK,MAAM,MAAK,MAAM,OAAOA,EAAK,OAAM,SAAS;AAAA,IAE/L,CAAS,GAED,KAAK,YAAY,YAAYD,EAAG,KAAK,EAAE,GACvC,KAAK,gBAAe,GAEpB,KAAK,YAAY,iBAAiB,cAAc,MAAM;AAClD,mBAAaJ,CAAK;AAAA,IAC9B,CAAS,GAED,KAAK,YAAY,iBAAiB,cAAc,MAAM;AAClD,mBAAaA,CAAK,GAElBA,IAAQ,WAAW,MAAM;AACrB,aAAK,KAAI;AAAA,MACzB,GAAe,KAAK,OAAO;AAAA,IAC3B,CAAS,GAED,KAAK,YAAY,iBAAiB,SAAS,CAAAM,MAAO;AAC9C,mBAAaN,CAAK;AAClB,UAAIO,IAASD,EAAI;AAEjB,UAAIC,EAAO,QAAQ,gBAAgB,GAAG;AAClC,YAAIC,IAAMD,EAAO,aAAa,UAAU,GAEpCE,IAAoB,KAAK,SAAS,OAAO,CAAAJ,MAClCA,EAAK,OAAOG,CACtB;AAED,QAAIC,EAAkB,SAAS,MAC3BD,IAAMC,EAAkB,CAAC,GAErB,OAAOD,EAAI,UAAU,cACrBA,EAAI,OAAM,IAIlB,KAAK,KAAI;AAAA,MACZ;AAAA,IACb,CAAS,GAED,SAAS,KAAK,OAAO,KAAK,WAAW;AAAA,EACxC;AAAA,EAED,kBAAkB;AACd,QAAIE,IAAgB,KAAK,YAAY,sBAAqB;AAE1D,SAAK,QAAQA,EAAc,OAC3B,KAAK,SAASA,EAAc;AAAA,EAC/B;AAAA,EAED,KAAKC,GAAIC,GAAGC,GAAG;AACX,iBAAab,CAAK,GAClB,KAAK,SAASW,GACd,KAAK,YAAY,aAAa,SAAS,EAAE,GACzC,KAAK,YAAY,MAAM,OAAOC,IAAI,MAClC,KAAK,YAAY,MAAM,MAAMC,IAAI,MACjC,KAAK,YAAY,UAAU,IAAI,QAAQ,GACvC,KAAK,YAAY,UAAU,IAAI,SAAS,GAExCb,IAAQ,WAAW,MAAM;AACrB,mBAAaA,CAAK,GAClB,KAAK,KAAI;AAAA,IACrB,GAAW,KAAK,OAAO;AAAA,EAClB;AAAA,EAED,OAAO;AACH,iBAAaA,CAAK,GAClB,KAAK,YAAY,UAAU,OAAO,QAAQ;AAAA,EAC7C;AACL;"}